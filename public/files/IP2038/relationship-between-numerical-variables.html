<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Relationship between numerical variables | IP2038 - Analysing Political and Economic Data in the Real World - Course Material</title>
<meta name="author" content="Stefano Pagliari">
<meta name="description" content="We have now seen that univariate descriptions provide important information about a single variable. For instance, we can use univariate plots or summary statistics to answer questions about...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 19 Relationship between numerical variables | IP2038 - Analysing Political and Economic Data in the Real World - Course Material">
<meta property="og:type" content="book">
<meta property="og:description" content="We have now seen that univariate descriptions provide important information about a single variable. For instance, we can use univariate plots or summary statistics to answer questions about...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 19 Relationship between numerical variables | IP2038 - Analysing Political and Economic Data in the Real World - Course Material">
<meta name="twitter:description" content="We have now seen that univariate descriptions provide important information about a single variable. For instance, we can use univariate plots or summary statistics to answer questions about...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">IP2038 - Analysing Political and Economic Data in the Real World - Course Material</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction to the Module</a></li>
<li class="book-part">Introduction to R</li>
<li><a class="" href="rstudio-and-rstudio-cloud.html"><span class="header-section-number">2</span> RStudio and RStudio Cloud</a></li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">3</span> Getting Started with R</a></li>
<li class="book-part">Datasets</li>
<li><a class="" href="importing-data-into-r.html"><span class="header-section-number">4</span> Importing Data into R</a></li>
<li><a class="" href="inspecting-a-dataset.html"><span class="header-section-number">5</span> Inspecting a Dataset</a></li>
<li><a class="" href="long-vs.-wide-data.html"><span class="header-section-number">6</span> Long vs. Wide Data</a></li>
<li><a class="" href="list-of-political-and-economic-datasets.html"><span class="header-section-number">7</span> List of Political and Economic Datasets</a></li>
<li class="book-part">Data Wrangling</li>
<li><a class="" href="data-wrangling-with-dplyr.html"><span class="header-section-number">8</span> Data Wrangling with dplyr</a></li>
<li><a class="" href="working-with-observations.html"><span class="header-section-number">9</span> Working with Observations</a></li>
<li><a class="" href="working-with-variables.html"><span class="header-section-number">10</span> Working with Variables</a></li>
<li><a class="" href="grouping-and-summarising-data.html"><span class="header-section-number">11</span> Grouping and Summarising Data</a></li>
<li><a class="" href="relational-data.html"><span class="header-section-number">12</span> Relational Data</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">13</span> Missing Data</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="data-visualization-with-ggplot.html"><span class="header-section-number">14</span> Data Visualization with ggplot</a></li>
<li><a class="" href="types-of-visualizations.html"><span class="header-section-number">15</span> Types of visualizations</a></li>
<li class="book-part">Exploratory Analysis</li>
<li><a class="" href="exploring-numerical-data.html"><span class="header-section-number">16</span> Exploring Numerical Data</a></li>
<li><a class="" href="exploring-categorical-data.html"><span class="header-section-number">17</span> Exploring Categorical Data</a></li>
<li><a class="" href="relationship-between-categorical-and-numerical-variables.html"><span class="header-section-number">18</span> Relationship between categorical and numerical variables</a></li>
<li><a class="active" href="relationship-between-numerical-variables.html"><span class="header-section-number">19</span> Relationship between numerical variables</a></li>
<li><a class="" href="relationship-between-categorical-variables.html"><span class="header-section-number">20</span> Relationship between categorical variables</a></li>
<li><a class="" href="time-series.html"><span class="header-section-number">21</span> Time Series</a></li>
<li><a class="" href="maps.html"><span class="header-section-number">22</span> Maps</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="assessment-guidance.html"><span class="header-section-number">A</span> Assessment Guidance</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="relationship-between-numerical-variables" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Relationship between numerical variables<a class="anchor" aria-label="anchor" href="#relationship-between-numerical-variables"><i class="fas fa-link"></i></a>
</h1>
<p>We have now seen that univariate descriptions provide important information about a single variable. For instance, we can use univariate plots or summary statistics to answer questions about central tendency and dispersion.</p>
<p>When we examine data, we often want to see how things are related. This is the purpose of bivariate analyses.</p>
<p>The main goal of this chapter is to show how to use descriptive statistics and visualisations to explore the relationship among different kinds of variables.</p>
<p>Now we will take a look at a series of graphs that examine relationships between two or more variables. There are different visual tools available, depending on the type of variables we are investigating.</p>
<div id="graphical-summaries-of-the-relationship-between-continuous-variables" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Graphical Summaries of the Relationship between Continuous Variables<a class="anchor" aria-label="anchor" href="#graphical-summaries-of-the-relationship-between-continuous-variables"><i class="fas fa-link"></i></a>
</h2>
<div id="scatterplot" class="section level3" number="19.1.1">
<h3>
<span class="header-section-number">19.1.1</span> Scatterplot<a class="anchor" aria-label="anchor" href="#scatterplot"><i class="fas fa-link"></i></a>
</h3>
<p>Scatterplots are one of the most common visualizations used in bivariate data analysis. By looking at scatter plots of two variables, we can see whether there might be a relationship between them.</p>
<p>Scatterplots are used to show the relationship between two <strong><em>continuous</em></strong> variables.</p>
<p>Each dot represents an observation in the dataset. Their position on the X (horizontal) and Y (vertical) axis represents the values of the 2 variables for that observation.</p>
<p>Scatterplots are built with <code>ggplot</code> using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function. <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> requires two variables to be identified within the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>:</p>
<ul>
<li>
<code>x</code> = variable to be plotted on the horizontal axis</li>
<li>
<code>y</code> = variable to be plotted on the vertical axis</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder">gapminder</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gapminder</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>

<span class="co">#Plot scatterplot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
<div id="customizing-scatterplots" class="section level4" number="19.1.1.1">
<h4>
<span class="header-section-number">19.1.1.1</span> Customizing Scatterplots<a class="anchor" aria-label="anchor" href="#customizing-scatterplots"><i class="fas fa-link"></i></a>
</h4>
<p>It is possible to customize the graphical look of the scatterplot by specifying the following parameters within <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> options:</p>
<ul>
<li><p><code>color</code>: the stroke color, the circle outline</p></li>
<li><p><code>stroke</code>: the stroke width</p></li>
<li><p><code>fill</code>: color of the circle inner part</p></li>
<li><p><code>shape</code>: shape of the marker. It takes a value betweeen 0 and 25 (see <a href="https://www.datanovia.com/en/blog/ggplot-point-shapes-best-tips/#:~:text=In%20ggplot,%20point%20shapes%20can%20be%20specified%20in,you%20can%20set%20manually%20point%20shapes%20and%20colors." class="uri">https://www.datanovia.com/en/blog/ggplot-point-shapes-best-tips/#:~:text=In%20ggplot,%20point%20shapes%20can%20be%20specified%20in,you%20can%20set%20manually%20point%20shapes%20and%20colors.</a>)</p></li>
<li><p><code>alpha</code>: circle transparency, [0-&gt;1], 0 is fully transparent</p></li>
<li><p><code>size</code>: circle size</p></li>
</ul>
<p>If these options are added manually in the geom_point call (outside of <code>aes</code>), they will be uniform among markers . You can also map them to a variable if put inside the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> part of the code.</p>
<p>It is also possible to map any of the graphical elements of a <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> them to a variable if put inside the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> part of the code.</p>
<p>For instance we can also use Scatter Plots to evaluate the relationship between two continuous variables while varying the colour or shape of the geom_point on the basis of different categories found in a Categorical Variable.</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gapminder</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>

<span class="co">#Plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, y<span class="op">=</span><span class="va">lifeExp</span>, colour <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
</div>
<div id="adding-labels-to-a-scatterplot" class="section level4" number="19.1.1.2">
<h4>
<span class="header-section-number">19.1.1.2</span> Adding Labels to a scatterplot<a class="anchor" aria-label="anchor" href="#adding-labels-to-a-scatterplot"><i class="fas fa-link"></i></a>
</h4>
<p>The geom <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code>can be used to add text as markers. While <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> plots uniquely a given text, <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code> adds a border around the text. Both <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code> require the following values:</p>
<ul>
<li><p><code>x</code>: position along the x axis where the text will be added</p></li>
<li><p><code>y</code>: position along the x axis where the text will be added</p></li>
<li><p><code>label</code>: what text you want to display (required). This can be mapped to a variable</p></li>
</ul>
<p>It is also possible to add the following optional values</p>
<ul>
<li><p><code>nudge_x</code> and <code>nudge_y</code>: shifts the text along X and Y axis (optional)</p></li>
<li><p><code>check_overlap</code> tries to avoid text overlap (the package <code>ggrepel</code> can also be used to achieve avoid overlaps)</p></li>
</ul>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("ggrepel")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>

<span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap_2007</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>


<span class="co">#Plot</span>


<span class="va">continent_gap</span> <span class="op">&lt;-</span> <span class="va">gap_2007</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>average_gdpPercap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gdpPercap</span><span class="op">)</span>,
            average_lifeExp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span>


<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">continent_gap</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">average_gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">average_lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">average_gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">average_lifeExp</span>, 
                 label <span class="op">=</span> <span class="va">continent</span><span class="op">)</span>,
            nudge_x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
</div>
<div id="highlighting-specific-observations" class="section level4" number="19.1.1.3">
<h4>
<span class="header-section-number">19.1.1.3</span> Highlighting specific observations<a class="anchor" aria-label="anchor" href="#highlighting-specific-observations"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gapminder</span>
<span class="va">gap</span> <span class="op">&lt;-</span> <span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>

<span class="co">#Plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span>,
             colour <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"China"</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span>,
            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span>,
            colour <span class="op">=</span> <span class="st">"Darkgreen"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"China"</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span>, 
                 label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>,
            size <span class="op">=</span> <span class="fl">3</span>,
            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"United Kingdom"</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span>, 
                 label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>,
            size <span class="op">=</span> <span class="fl">3</span>,
            colour <span class="op">=</span> <span class="st">"Darkgreen"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span>  </code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
</div>
</div>
<div id="bubble-plot" class="section level3" number="19.1.2">
<h3>
<span class="header-section-number">19.1.2</span> Bubble Plot<a class="anchor" aria-label="anchor" href="#bubble-plot"><i class="fas fa-link"></i></a>
</h3>
<p>A <a href="https://www.data-to-viz.com/graph/bubble.html">bubble plot</a> is a scatter plot, where the size of the different points is adjusted according to a third numerical variable.</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 
<span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap_2007</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span> 


<span class="co"># Mutate Pop</span>
<span class="va">gap_2007</span> <span class="op">&lt;-</span> <span class="va">gap_2007</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pop_million <span class="op">=</span> <span class="va">pop</span><span class="op">/</span><span class="fl">1000000</span><span class="op">)</span>

<span class="co">#Plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap_2007</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span>, 
                 colour <span class="op">=</span> <span class="va">continent</span>,
                size <span class="op">=</span> <span class="va">pop_million</span><span class="op">)</span>,
             alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span>,
        size <span class="op">=</span> <span class="st">"Population (million)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span>  </code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
</div>
<div id="other-visualizations" class="section level3" number="19.1.3">
<h3>
<span class="header-section-number">19.1.3</span> Other visualizations<a class="anchor" aria-label="anchor" href="#other-visualizations"><i class="fas fa-link"></i></a>
</h3>
<p>In addition to <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, ggplot2 provides a couple of different geom functions for producing a visual summary of relationships between numeric variables in situations where over-plotting of points is obscuring the relationship.</p>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count()</a></code> function is a variant of <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> that first group data into sets of identical observations. The number of cases in each group is counted, and this number is used to scale the size of points, This visualization works better with round numeric variables.</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">cty</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<p>Similarly, the <code>geom_hex</code> function (part of the hexbin package) works in a similar way but it divides the plane into regular hexagons.</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("hexbin")</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">cty</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-17-1.png" width="672"></div>
</div>
<div id="plotting-linear-trends-in-r" class="section level3" number="19.1.4">
<h3>
<span class="header-section-number">19.1.4</span> Plotting Linear Trends in R<a class="anchor" aria-label="anchor" href="#plotting-linear-trends-in-r"><i class="fas fa-link"></i></a>
</h3>
<p><code>ggplot2</code> provides the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> function that allows to add the linear trend and the confidence interval around it if needed (option <code>se=TRUE</code>).</p>
<p>The <code>method</code> argument allows to apply different smoothing method like lm, glm, loess and more</p>
<div id="linear-regression-line-method-lm" class="section level4" number="19.1.4.1">
<h4>
<span class="header-section-number">19.1.4.1</span> Linear Regression Line (method = “lm”)<a class="anchor" aria-label="anchor" href="#linear-regression-line-method-lm"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap_2007</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>

<span class="co">#Plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap_2007</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span>, 
                 fill <span class="op">=</span> <span class="va">continent</span><span class="op">)</span>,
             alpha<span class="op">=</span><span class="fl">0.5</span>, shape<span class="op">=</span><span class="fl">21</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span>,
              method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span>,
        size <span class="op">=</span> <span class="st">"Population"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
</div>
<div id="curve-method-loess" class="section level4" number="19.1.4.2">
<h4>
<span class="header-section-number">19.1.4.2</span> Curve (method = “loess”)<a class="anchor" aria-label="anchor" href="#curve-method-loess"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load and filter the gapminder dataset</span>
<span class="va">gap_2007</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="st">"2007"</span><span class="op">)</span>

<span class="co">#Plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gap_2007</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span>, 
                 fill <span class="op">=</span> <span class="va">continent</span><span class="op">)</span>,
             alpha<span class="op">=</span><span class="fl">0.5</span>, shape<span class="op">=</span><span class="fl">21</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gdpPercap</span>, 
                 y<span class="op">=</span><span class="va">lifeExp</span><span class="op">)</span>,
              method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GDP per Capita and Live Expectancy"</span>,
          x <span class="op">=</span> <span class="st">"GDP per Capita"</span>,
          y <span class="op">=</span> <span class="st">"Life Expectancy"</span>,
          caption <span class="op">=</span> <span class="st">"Data From Gapminder"</span>,
        size <span class="op">=</span> <span class="st">"Population"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="94_Bivariate_Relationships_files/figure-html/unnamed-chunk-19-1.png" width="672"></div>
</div>
</div>
</div>
<div id="statistical-measures-of-association-between-numeric-variables" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Statistical measures of association between numeric variables<a class="anchor" aria-label="anchor" href="#statistical-measures-of-association-between-numeric-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Statisticians have developed different ways to quantify an association between two numeric variables. Correlation coefficients are the most common measure and the terms correlation and association are often used interchangeably.</p>
<div id="pearsons-correlation-coefficient" class="section level3" number="19.2.1">
<h3>
<span class="header-section-number">19.2.1</span> Pearson’s Correlation coefficient<a class="anchor" aria-label="anchor" href="#pearsons-correlation-coefficient"><i class="fas fa-link"></i></a>
</h3>
<p>Pearson’s Correlation coefficient is the most frequently used summary statistic used to measure the strength of the linear relationship between two continuous variables.</p>
<p>A Pearson correlation attempts to draw a line of best fit through the data of two variables, and the Pearson correlation coefficient, r, indicates how far away all these data points are to this line of best fit (i.e., how well the data points fit this new model/line of best fit).</p>
<p>The mathematical formula for the Pearson’s correlation coefficient applied to a sample is:</p>
<p><span class="math display">\[ 
r = \frac{{\sum_{i}(x_i -\overline{x})(y_i -\overline{y})}}{\sqrt{\sum_{i}(x_i -\overline{x})^2}\sqrt{\sum_{i}(x_i -\overline{x})^2}}
\]</span>
where:</p>
<ul>
<li>r = correlation coefficient</li>
<li>x_{i} = values of the x-variable in a sample</li>
<li>{x} = mean of the values of the x-variable</li>
<li>y_{i} = values of the y-variable in a sample</li>
<li>{y} = mean of the values of the y-variable</li>
</ul>
<p>Pearson’s correlation coefficient takes a value of 0 if two variables are uncorrelated, and a value of +1 or -1 if they are perfectly related.
When two variables are perfectly related, this means that we are able to predict the exact value of one variable given knowledge of the other.</p>
<p>A positive value in the correlation coefficient (0-1) indicates that high values in one variable is associated with high values of the second. A negative correlation coefficient (-1-0) indicates that high values of one variable is associated with low values of the second.</p>
<p>For instance, the figure below shows a series of linear relationships that vary in their strength and direction.</p>
<div class="inline-figure">
<img src="images/Correlation_Coeff_Plot1" style="width:90.0%">(Source: Childs 2019)</div>
</div>
<div id="calculating-correlation-statistic-in-r" class="section level3" number="19.2.2">
<h3>
<span class="header-section-number">19.2.2</span> Calculating Correlation Statistic in R<a class="anchor" aria-label="anchor" href="#calculating-correlation-statistic-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>We can calculate Pearson’s Correlation in R using the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function:</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">lifeExp</span>, <span class="va">gapminder</span><span class="op">$</span><span class="va">gdpPercap</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.5837062</span></code></pre></div>
<p>This is positive, indicating that life expectancy in a country tends to increase with increasing gdp per capita. The value (0.58) is quite large, indicating a clear association between teh two, but not close to 1, indicating that one variable does not completely predict the other.</p>
</div>
<div id="interpreting-the-correlation-coefficient" class="section level3" number="19.2.3">
<h3>
<span class="header-section-number">19.2.3</span> Interpreting the Correlation Coefficient<a class="anchor" aria-label="anchor" href="#interpreting-the-correlation-coefficient"><i class="fas fa-link"></i></a>
</h3>
<p>The Pearson’s correlation coefficient needs to be interpreted carefully.</p>
<div id="linear-vs.-non-linear-relationship" class="section level4" number="19.2.3.1">
<h4>
<span class="header-section-number">19.2.3.1</span> Linear vs. non-linear relationship<a class="anchor" aria-label="anchor" href="#linear-vs.-non-linear-relationship"><i class="fas fa-link"></i></a>
</h4>
<p>A correlation coefficient quantifies the degree to which an association tends to a certain pattern. In the case of Pearson’s correlation coefficient, the coefficient is designed to summarise the strength of a linear (i.e. ‘straight line’) association. As a result, the measure will be misleading when the relationship between the two variables is curved or hump-shaped.</p>
<p>For instance, the figure below reveals a number of combinations where two variables are related but not in a linear way, yet the correlation coefficient is always 0.</p>
<div class="inline-figure">
<img src="images/Correlation_Coeff_Plot3.png" style="width:90.0%">(Source: Childs 2019)</div>
</div>
<div id="steepness" class="section level4" number="19.2.3.2">
<h4>
<span class="header-section-number">19.2.3.2</span> Steepness<a class="anchor" aria-label="anchor" href="#steepness"><i class="fas fa-link"></i></a>
</h4>
<p>Moreover, even in the case the relationship between two variables is linear, Pearson’s correlation coefficient tells us nothing about the slope (i.e. the steepness) of the relationship, and if an increase in the value of one variable will correspond to a large or small increase/decrease in the other variable.</p>
<p>For instance, the figure below shows different configurations that have the same correlation coefficients but where the steepness of the relationship varies significantly.</p>
<div class="inline-figure">
<img src="images/Correlation_Coeff_Plot2.png" style="width:90.0%">(Source: Childs 2019)</div>
</div>
<div id="outliers-1" class="section level4" number="19.2.3.3">
<h4>
<span class="header-section-number">19.2.3.3</span> Outliers<a class="anchor" aria-label="anchor" href="#outliers-1"><i class="fas fa-link"></i></a>
</h4>
<p>Outliers can have a very large effect on the line of best fit and the Pearson correlation coefficient/ This point is most easily illustrated by studying scatterplots of a linear relationship with an outlier included and after its removal, with respect to both the line of best fit and the correlation coefficient. This is illustrated in the two images below below:</p>
<div class="inline-figure">
<img src="images/pearson-outlier.png">{width:90%}(source: Laerd Statistics (2020).)</div>
<p>Visualizing the relationship between two continuous variables will reveal which of these scenarios is true.</p>
</div>
</div>
<div id="other-measures-of-correlation" class="section level3" number="19.2.4">
<h3>
<span class="header-section-number">19.2.4</span> Other measures of correlation<a class="anchor" aria-label="anchor" href="#other-measures-of-correlation"><i class="fas fa-link"></i></a>
</h3>
<p>Other measures of correlation are available to assess whether two variables are associated in a non-linear way.</p>
<p>Rank correlation is based not on the the actual values but on their ranked position in the distribution (e.g. ‘first, ’second’, ‘third’). Measures of rank correlation are based on a comparison of the resulting ranks.</p>
<p>he two most popular are Spearman’s ρ (‘rho’) and Kendall’s<br>
τ (‘tau’).We can calculate both rank correlation coefficients in R using the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function again, while specifying that<code>method = "kendall"</code> or <code>method = "spearman"</code>.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">lifeExp</span>, <span class="va">gapminder</span><span class="op">$</span><span class="va">gdpPercap</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.6369107</span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">lifeExp</span>, <span class="va">gapminder</span><span class="op">$</span><span class="va">gdpPercap</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.8264712</span></code></pre></div>
<p>Both coefficients of the Spearman’s ρ (‘rho’) and Kendall’s τ (‘tau’) behave in a very similar way to Pearson’s correlation coefficient. They take a value of 0 if the ranks are uncorrelated, and a value of +1 or -1 if they are perfectly related, while the sign indicates the direction of the association.</p>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="relationship-between-categorical-and-numerical-variables.html"><span class="header-section-number">18</span> Relationship between categorical and numerical variables</a></div>
<div class="next"><a href="relationship-between-categorical-variables.html"><span class="header-section-number">20</span> Relationship between categorical variables</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#relationship-between-numerical-variables"><span class="header-section-number">19</span> Relationship between numerical variables</a></li>
<li>
<a class="nav-link" href="#graphical-summaries-of-the-relationship-between-continuous-variables"><span class="header-section-number">19.1</span> Graphical Summaries of the Relationship between Continuous Variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#scatterplot"><span class="header-section-number">19.1.1</span> Scatterplot</a></li>
<li><a class="nav-link" href="#bubble-plot"><span class="header-section-number">19.1.2</span> Bubble Plot</a></li>
<li><a class="nav-link" href="#other-visualizations"><span class="header-section-number">19.1.3</span> Other visualizations</a></li>
<li><a class="nav-link" href="#plotting-linear-trends-in-r"><span class="header-section-number">19.1.4</span> Plotting Linear Trends in R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#statistical-measures-of-association-between-numeric-variables"><span class="header-section-number">19.2</span> Statistical measures of association between numeric variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pearsons-correlation-coefficient"><span class="header-section-number">19.2.1</span> Pearson’s Correlation coefficient</a></li>
<li><a class="nav-link" href="#calculating-correlation-statistic-in-r"><span class="header-section-number">19.2.2</span> Calculating Correlation Statistic in R</a></li>
<li><a class="nav-link" href="#interpreting-the-correlation-coefficient"><span class="header-section-number">19.2.3</span> Interpreting the Correlation Coefficient</a></li>
<li><a class="nav-link" href="#other-measures-of-correlation"><span class="header-section-number">19.2.4</span> Other measures of correlation</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>IP2038 - Analysing Political and Economic Data in the Real World - Course Material</strong>" was written by Stefano Pagliari. It was last built on 2022-04-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
